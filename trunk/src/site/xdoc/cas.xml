<?xml version="1.0" encoding="UTF-8"?>
<document>
	<properties>
		<title>Implementing SSO using JASIG CAS</title>
		<author email="fxbonnet@users.sourceforge.net">Francois-Xavier Bonnet</author>
	</properties>
	<body>
	<h1>Implementing SSO using JASIG CAS</h1>
		<section name="Principles">
			<p>
				The toolkit can do CAS authentication using the JASIG CAS client.
				The
				toolkit will
				then use CAS
				<a
					href="http://www.jasig.org/cas/proxy-authentication">proxy authentication mode</a>
				to authenticate the user while processing block or template
				includes.
			</p>
		</section>
		<section name="Configuring CAS on the aggregator or master application
	">
			<p>
				You will have to define all the URL that have to be behind CAS
				authentication. WARN: CAS has to be configured in proxy mode, this
				means configuring proxyCallbackUrl and proxyReceptorUrl. Unless you
				disable security on the CAS server CAS AND the aggregator
				application
				MUST be in HTTPS!
	</p>
<source>
&lt;filter&gt;
	&lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.authentication.AuthenticationFilter&lt;/filter-class&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;casServerLoginUrl&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080/esigate-app-cas/login&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;serverName&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
	&lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter&gt;
	&lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter&lt;/filter-class&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;casServerUrlPrefix&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080/esigate-app-cas&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;serverName&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;proxyCallbackUrl&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080/esigate-app-casified-aggregator/proxy/receptor&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;proxyReceptorUrl&lt;/param-name&gt;
		&lt;param-value&gt;/proxy/receptor&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;redirectAfterValidation&lt;/param-name&gt;
		&lt;param-value&gt;true&lt;/param-value&gt;
	&lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter&gt;
	&lt;filter-name&gt;CAS HttpServletRequest Wrapper Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.util.HttpServletRequestWrapperFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter&gt;
	&lt;filter-name&gt;CAS Assertion Thread Local Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.util.AssertionThreadLocalFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS HttpServletRequest Wrapper Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS Assertion Thread Local Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</source>
	In addition, you must configure the AuthenticationHandler in
	driver.properties file for each provider:
<source>
authenticationHandler=org.esigate.cas.CasAuthenticationHandler
aggregated2.authenticationHandler=org.esigate.cas.CasAuthenticationHandler
</source>
		</section>
		<section
			name="Configuring CAS on the aggregated or provider
		applications">
			<p>
				Aggregated applications can use any CAS client but must be
				configured to accept proxy chains.
	</p>
<source>
&lt;filter&gt;
	&lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.authentication.AuthenticationFilter&lt;/filter-class&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;casServerLoginUrl&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080/esigate-app-cas/login&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;serverName&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
	&lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter&gt;
	&lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter&lt;/filter-class&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;casServerUrlPrefix&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080/esigate-app-cas&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;serverName&lt;/param-name&gt;
		&lt;param-value&gt;http://localhost:8080&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;redirectAfterValidation&lt;/param-name&gt;
		&lt;param-value&gt;true&lt;/param-value&gt;
	&lt;/init-param&gt;
	&lt;init-param&gt;
		&lt;param-name&gt;acceptAnyProxy&lt;/param-name&gt;
		&lt;param-value&gt;true&lt;/param-value&gt;
	&lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter&gt;
	&lt;filter-name&gt;CAS HttpServletRequest Wrapper Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.util.HttpServletRequestWrapperFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter&gt;
	&lt;filter-name&gt;CAS Assertion Thread Local Filter&lt;/filter-name&gt;
	&lt;filter-class&gt;org.jasig.cas.client.util.AssertionThreadLocalFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS Validation Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS Authentication Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS HttpServletRequest Wrapper Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;filter-mapping&gt;
	&lt;filter-name&gt;CAS Assertion Thread Local Filter&lt;/filter-name&gt;
	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</source>
		</section>
	</body>
</document>